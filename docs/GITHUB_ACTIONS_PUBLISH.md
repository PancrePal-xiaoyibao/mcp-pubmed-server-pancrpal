# GitHub Actions è‡ªåŠ¨å‘å¸ƒåˆ° npm ä½¿ç”¨æŒ‡å—

æœ¬é¡¹ç›®å·²é…ç½® GitHub Actions å·¥ä½œæµï¼Œæ”¯æŒåŸºäº Git Tag çš„è‡ªåŠ¨æ‰“åŒ…å¹¶å‘å¸ƒåˆ° npmjs ä»“åº“ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®æ¡ä»¶

1. **npm è´¦å·å’Œ Token**
   - åœ¨ [npmjs.com](https://www.npmjs.com/) æ³¨å†Œè´¦å·ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
   - åˆ›å»º Access Tokenï¼š
     - è®¿é—® https://www.npmjs.com/settings/your-username/tokens
     - ç‚¹å‡» "Generate New Token" â†’ "Automation"
     - å¤åˆ¶ç”Ÿæˆçš„ token

2. **é…ç½® GitHub Secrets**
   - è¿›å…¥ä½ çš„ GitHub ä»“åº“
   - ç‚¹å‡» `Settings` â†’ `Secrets and variables` â†’ `Actions`
   - ç‚¹å‡» `New repository secret`
   - åç§°ï¼š`NPM_TOKEN`
   - å€¼ï¼šç²˜è´´ä½ çš„ npm Access Token
   - ç‚¹å‡» `Add secret`

## ğŸ“¦ å‘å¸ƒæ–¹å¼

### Git Tag è‡ªåŠ¨è§¦å‘ï¼ˆå”¯ä¸€æ–¹å¼ï¼‰

å·¥ä½œæµå®Œå…¨è‡ªåŠ¨åŒ–ï¼Œåªéœ€æ¨é€ Git Tag å³å¯è§¦å‘å‘å¸ƒï¼š

1. **åœ¨æœ¬åœ°åˆ›å»ºå¹¶æ¨é€ Git Tag**ï¼š
   ```bash
   git tag v1.0.1
   git push origin v1.0.1
   ```

2. **GitHub Actions ä¼šè‡ªåŠ¨æ‰§è¡Œ**ï¼š
   - âœ… æ£€æµ‹åˆ° Tag æ¨é€
   - âœ… æå–ç‰ˆæœ¬å·ï¼ˆè‡ªåŠ¨ç§»é™¤ `v` å‰ç¼€ï¼‰
   - âœ… æ›´æ–° `package.json` ç‰ˆæœ¬å·
   - âœ… å®‰è£…ä¾èµ–
   - âœ… è¿è¡Œæµ‹è¯•ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
   - âœ… å‘å¸ƒåˆ° npm

**Tag å‘½åè§„åˆ™**ï¼š
- å¿…é¡»ä»¥ `v` å¼€å¤´ï¼ˆä¾‹å¦‚ï¼š`v1.0.1`ï¼‰
- ç‰ˆæœ¬å·æ ¼å¼ï¼š`x.y.z`ï¼ˆä¾‹å¦‚ï¼š`1.0.1`, `1.1.0`, `2.0.0`ï¼‰
- å·¥ä½œæµä¼šè‡ªåŠ¨éªŒè¯ç‰ˆæœ¬å·æ ¼å¼

## ğŸ” å·¥ä½œæµè¯´æ˜

### å·¥ä½œæµæ­¥éª¤

1. **æ£€å‡ºä»£ç ** - è·å–æœ€æ–°ä»£ç å’Œå®Œæ•´ Git å†å²
2. **è®¾ç½® Node.js** - å®‰è£… Node.js 18 å¹¶é…ç½® npm registry
3. **æ£€æµ‹ç‰ˆæœ¬å·** - ä» Git Tag ä¸­æå–ç‰ˆæœ¬å·ï¼ˆç§»é™¤ `v` å‰ç¼€ï¼‰
4. **éªŒè¯ç‰ˆæœ¬å·** - ç¡®ä¿ç‰ˆæœ¬å·æ ¼å¼ä¸º `x.y.z`
5. **æ›´æ–° package.json** - è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·
6. **å®‰è£…ä¾èµ–** - è¿è¡Œ `npm ci`
7. **è¿è¡Œæµ‹è¯•** - å¦‚æœå­˜åœ¨æµ‹è¯•è„šæœ¬ï¼ˆå¯é€‰ï¼Œå¤±è´¥ä¸é˜»æ­¢å‘å¸ƒï¼‰
8. **å‘å¸ƒåˆ° npm** - è‡ªåŠ¨å‘å¸ƒåˆ° npmjs ä»“åº“

### ç‰ˆæœ¬å·éªŒè¯

å·¥ä½œæµä¼šè‡ªåŠ¨éªŒè¯ç‰ˆæœ¬å·æ ¼å¼ï¼Œå¿…é¡»æ˜¯ `x.y.z` æ ¼å¼ï¼ˆä¾‹å¦‚ï¼š`1.0.1`ï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™å¹¶åœæ­¢å·¥ä½œæµã€‚

## ğŸ“ å‘å¸ƒæ¸…å•

å‘å¸ƒå‰è¯·ç¡®è®¤ï¼š

- [ ] `package.json` ä¸­çš„ `name` å­—æ®µæ­£ç¡®ï¼ˆç¡®ä¿ npm åŒ…åå¯ç”¨ï¼‰
- [ ] `package.json` ä¸­çš„ `repository` URL å·²æ›´æ–°ä¸ºå®é™…ä»“åº“åœ°å€
- [ ] `package.json` ä¸­çš„ `author` ä¿¡æ¯å·²æ›´æ–°
- [ ] GitHub Secrets ä¸­å·²é…ç½® `NPM_TOKEN`
- [ ] ä»£ç å·²é€šè¿‡æµ‹è¯•ï¼ˆå¦‚æœæœ‰ï¼‰
- [ ] ç‰ˆæœ¬å·éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒï¼ˆSemVerï¼‰
- [ ] å·²æäº¤æ‰€æœ‰ä»£ç æ›´æ”¹åˆ°ä¸»åˆ†æ”¯

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **npm åŒ…åå”¯ä¸€æ€§**
   - ç¡®ä¿ `mcp-pubmed-llm-server` è¿™ä¸ªåŒ…ååœ¨ npm ä¸Šå¯ç”¨
   - å¦‚æœå·²è¢«å ç”¨ï¼Œéœ€è¦ä¿®æ”¹ `package.json` ä¸­çš„ `name` å­—æ®µ

2. **ç‰ˆæœ¬å·é€’å¢**
   - æ¯æ¬¡å‘å¸ƒå¿…é¡»ä½¿ç”¨æ¯”å½“å‰ç‰ˆæœ¬æ›´é«˜çš„ç‰ˆæœ¬å·
   - npm ä¸å…è®¸å‘å¸ƒç›¸åŒæˆ–æ›´ä½ç‰ˆæœ¬å·çš„åŒ…

3. **Git Tag ä¸ç‰ˆæœ¬å·**
   - ç‰ˆæœ¬å·ä¼šè‡ªåŠ¨ä» Git Tag ä¸­æå–
   - Tag æ ¼å¼ï¼š`v1.0.1` â†’ ç‰ˆæœ¬å·ï¼š`1.0.1`
   - æ¨é€ Tag åä¼šè‡ªåŠ¨è§¦å‘å‘å¸ƒï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ

4. **è‡ªåŠ¨å‘å¸ƒ**
   - æ¨é€ Git Tag åï¼Œå·¥ä½œæµä¼šè‡ªåŠ¨æ‰§è¡Œå‘å¸ƒæµç¨‹
   - æ— éœ€åœ¨ GitHub Actions ç•Œé¢æ‰‹åŠ¨è§¦å‘
   - å¦‚æœå‘å¸ƒå¤±è´¥ï¼Œå¯ä»¥åœ¨ Actions æ ‡ç­¾é¡µæŸ¥çœ‹è¯¦ç»†æ—¥å¿—

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ï¼šå‘å¸ƒå¤±è´¥ï¼Œæç¤º "You cannot publish over the previously published versions"

**è§£å†³æ–¹æ¡ˆ**ï¼šç‰ˆæœ¬å·å·²å­˜åœ¨ï¼Œéœ€è¦åˆ›å»ºæ–°çš„æ›´é«˜ç‰ˆæœ¬å·çš„ Tagï¼ˆä¾‹å¦‚ï¼šä» `v1.0.0` æ”¹ä¸º `v1.0.1`ï¼‰

### é—®é¢˜ï¼šå‘å¸ƒå¤±è´¥ï¼Œæç¤º "Invalid package name"

**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥ `package.json` ä¸­çš„ `name` å­—æ®µï¼Œç¡®ä¿ç¬¦åˆ npm å‘½åè§„èŒƒ

### é—®é¢˜ï¼šGitHub Actions æç¤º "NPM_TOKEN not found"

**è§£å†³æ–¹æ¡ˆ**ï¼šåœ¨ GitHub ä»“åº“çš„ Settings â†’ Secrets ä¸­æ·»åŠ  `NPM_TOKEN`

### é—®é¢˜ï¼šGit Tag è§¦å‘å¤±è´¥æˆ–æœªè§¦å‘

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿ Tag æ ¼å¼æ­£ç¡®ï¼ˆå¿…é¡»ä»¥ `v` å¼€å¤´ï¼Œå¦‚ `v1.0.1`ï¼‰
- ç¡®ä¿ Tag å·²æ¨é€åˆ° GitHubï¼ˆ`git push origin v1.0.1`ï¼‰
- æ£€æŸ¥ GitHub Actions å·¥ä½œæµæ˜¯å¦å¯ç”¨ï¼ˆSettings â†’ Actions â†’ Generalï¼‰

### é—®é¢˜ï¼šç‰ˆæœ¬å·æ ¼å¼éªŒè¯å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
- Tag å¿…é¡»ç¬¦åˆ `vx.y.z` æ ¼å¼ï¼ˆä¾‹å¦‚ï¼š`v1.0.1`ï¼‰
- ç‰ˆæœ¬å·å¿…é¡»æ˜¯æ•°å­—æ ¼å¼ï¼ˆä¾‹å¦‚ï¼š`1.0.1`ï¼Œä¸èƒ½æ˜¯ `1.0.1-beta`ï¼‰

## ğŸ“š ç›¸å…³èµ„æº

- [npm å‘å¸ƒæ–‡æ¡£](https://docs.npmjs.com/packages-and-modules/contributing-packages-to-the-registry)
- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ](https://semver.org/lang/zh-CN/)

